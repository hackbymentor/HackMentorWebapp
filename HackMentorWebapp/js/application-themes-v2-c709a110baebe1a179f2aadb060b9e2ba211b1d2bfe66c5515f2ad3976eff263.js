// Generated by CoffeeScript 1.4.0
(function(){var e,t,a,c,l,d,m,f,y,_,g,k,A,C,w,b,S,T,E,P=[].slice,D=[].indexOf||function(e){for(var t=0,a=this.length;t<a;t++)if(t in this&&this[t]===e)return t;return-1};(e=jQuery).payment={},e.payment.fn={},e.fn.payment=function(){var t,a;return a=arguments[0],t=2<=arguments.length?P.call(arguments,1):[],e.payment.fn[a].apply(this,t)},c=[{type:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,format:l=/(\d{1,4})/g,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:l,length:[14],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:l,length:[16,17,18,19],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:l,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:l,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:l,length:[16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[1-5]/,format:l,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"visa",pattern:/^4/,format:l,length:[13,14,15,16],cvcLength:[3],luhn:!0}],t=function(e){var t,a,l;for(e=(e+"").replace(/\D/g,""),a=0,l=c.length;a<l;a++)if((t=c[a]).pattern.test(e))return t},a=function(e){var t,a,l;for(a=0,l=c.length;a<l;a++)if((t=c[a]).type===e)return t},A=function(e){var t,a,c,l,d,m;for(c=!0,l=0,d=0,m=(a=(e+"").split("").reverse()).length;d<m;d++)t=a[d],t=parseInt(t,10),(c=!c)&&(t*=2),t>9&&(t-=9),l+=t;return l%10==0},k=function(e){var t;return null!=e.prop("selectionStart")&&e.prop("selectionStart")!==e.prop("selectionEnd")||!!("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)&&"function"==typeof t.createRange?t.createRange().text:void 0)},C=function(t){return setTimeout((function(){var a,c;return c=(a=e(t.currentTarget)).val(),c=e.payment.formatCardNumber(c),a.val(c)}))},f=function(a){var c,l,d,m,f,y,_;if(d=String.fromCharCode(a.which),/^\d+$/.test(d)&&(_=(c=e(a.currentTarget)).val(),l=t(_+d),m=(_.replace(/\D/g,"")+d).length,y=16,l&&(y=l.length[l.length.length-1]),!(m>=y||null!=c.prop("selectionStart")&&c.prop("selectionStart")!==_.length)))return(f=l&&"amex"===l.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(_)?(a.preventDefault(),c.val(_+" "+d)):f.test(_+d)?(a.preventDefault(),c.val(_+d+" ")):void 0},d=function(t){var a,c;if(c=(a=e(t.currentTarget)).val(),!t.meta&&8===t.which&&(null==a.prop("selectionStart")||a.prop("selectionStart")===c.length))return/\d\s$/.test(c)?(t.preventDefault(),a.val(c.replace(/\d\s$/,""))):/\s\d?$/.test(c)?(t.preventDefault(),a.val(c.replace(/\s\d?$/,""))):void 0},y=function(t){var a,c,l;if(c=String.fromCharCode(t.which),/^\d+$/.test(c))return l=(a=e(t.currentTarget)).val()+c,/^\d$/.test(l)&&"0"!==l&&"1"!==l?(t.preventDefault(),a.val("0"+l+" / ")):/^\d\d$/.test(l)?(t.preventDefault(),a.val(l+" / ")):void 0},_=function(t){var a,c,l;if(c=String.fromCharCode(t.which),/^\d+$/.test(c))return l=(a=e(t.currentTarget)).val(),/^\d\d$/.test(l)?a.val(l+" / "):void 0},g=function(t){var a,c;if("/"===String.fromCharCode(t.which))return c=(a=e(t.currentTarget)).val(),/^\d$/.test(c)&&"0"!==c?a.val("0"+c+" / "):void 0},m=function(t){var a,c;if(!t.meta&&(c=(a=e(t.currentTarget)).val(),8===t.which&&(null==a.prop("selectionStart")||a.prop("selectionStart")===c.length)))return/\d(\s|\/)+$/.test(c)?(t.preventDefault(),a.val(c.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(c)?(t.preventDefault(),a.val(c.replace(/\s\/\s?\d?$/,""))):void 0},T=function(e){var t;return!(!e.metaKey&&!e.ctrlKey)||32!==e.which&&(0===e.which||(e.which<33||(t=String.fromCharCode(e.which),!!/[\d\s]/.test(t))))},b=function(a){var c,l,d,m;if(c=e(a.currentTarget),d=String.fromCharCode(a.which),/^\d+$/.test(d)&&!k(c))return m=(c.val()+d).replace(/\D/g,""),(l=t(m))?m.length<=l.length[l.length.length-1]:m.length<=16},S=function(t){var a,c;if(a=e(t.currentTarget),c=String.fromCharCode(t.which),/^\d+$/.test(c)&&!k(a))return!((a.val()+c).replace(/\D/g,"").length>6)&&void 0},w=function(t){var a,c;if(a=e(t.currentTarget),c=String.fromCharCode(t.which),/^\d+$/.test(c))return(a.val()+c).length<=4},E=function(t){var a,l,d,m,f;if(f=(a=e(t.currentTarget)).val(),m=e.payment.cardType(f)||"unknown",!a.hasClass(m))return l=function(){var e,t,a;for(a=[],e=0,t=c.length;e<t;e++)d=c[e],a.push(d.type);return a}(),a.removeClass("unknown"),a.removeClass(l.join(" ")),a.addClass(m),a.toggleClass("identified","unknown"!==m),a.trigger("payment.cardType",m)},e.payment.fn.formatCardCVC=function(){return this.payment("restrictNumeric"),this.on("keypress",w),this},e.payment.fn.formatCardExpiry=function(){return this.payment("restrictNumeric"),this.on("keypress",S),this.on("keypress",y),this.on("keypress",g),this.on("keypress",_),this.on("keydown",m),this},e.payment.fn.formatCardNumber=function(){return this.payment("restrictNumeric"),this.on("keypress",b),this.on("keypress",f),this.on("keydown",d),this.on("keyup",E),this.on("paste",C),this},e.payment.fn.restrictNumeric=function(){return this.on("keypress",T),this},e.payment.fn.cardExpiryVal=function(){return e.payment.cardExpiryVal(e(this).val())},e.payment.cardExpiryVal=function(e){var t,a,c;return t=(c=(e=e.replace(/\s/g,"")).split("/",2))[0],2===(null!=(a=c[1])?a.length:void 0)&&/^\d+$/.test(a)&&(a=(new Date).getFullYear().toString().slice(0,2)+a),{month:t=parseInt(t,10),year:a=parseInt(a,10)}},e.payment.validateCardNumber=function(e){var a,c;return e=(e+"").replace(/\s+|-/g,""),!!/^\d+$/.test(e)&&(!!(a=t(e))&&(c=e.length,D.call(a.length,c)>=0&&(!1===a.luhn||A(e))))},e.payment.validateCardExpiry=function(t,a){var c,l,d;return"object"==typeof t&&"month"in t&&(t=(d=t).month,a=d.year),!(!t||!a)&&(t=e.trim(t),a=e.trim(a),!!/^\d+$/.test(t)&&(!!/^\d+$/.test(a)&&(parseInt(t,10)<=12&&(2===a.length&&(a=(new Date).getFullYear().toString().slice(0,2)+a),l=new Date(a,t),c=new Date,l.setMonth(l.getMonth()-1),l.setMonth(l.getMonth()+1,1),l>c))))},e.payment.validateCardCVC=function(t,c){var l,d;return t=e.trim(t),!!/^\d+$/.test(t)&&(c?(l=t.length,D.call(null!=(d=a(c))?d.cvcLength:void 0,l)>=0):t.length>=3&&t.length<=4)},e.payment.cardType=function(e){var a;return e&&(null!=(a=t(e))?a.type:void 0)||null},e.payment.formatCardNumber=function(e){var a,c,l,d;return(a=t(e))?(l=a.length[a.length.length-1],e=(e=e.replace(/\D/g,"")).slice(0,+l+1||9e9),a.format.global?null!=(d=e.match(a.format))?d.join(" "):void 0:(null!=(c=a.format.exec(e))&&c.shift(),null!=c?c.join(" "):void 0)):e}}).call(this),function(){var e;e=function(){var e,t,a,c,l;function Analytics(){}return a=[],t="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),5,e=500,Analytics.prototype.identify_for_thinkific=function(t,a,c,d){var m,f,y,_,g,k,A,C;return null==d&&(d={}),C=Object.assign(d,{user_id:t,tenant_id:a,"Customer Status":c["Subscription Plan"]}),f=l("first"),y=l("last"),_=Object.assign(y,C),k=Object.assign(f,c),g=Object.assign(y,c),null==("undefined"!=typeof mixpanel&&null!==mixpanel?mixpanel.config:void 0)?(m=0,A=function(){if(null!=("undefined"!=typeof mixpanel&&null!==mixpanel?mixpanel.config:void 0)){if(mixpanel.identify(t),mixpanel.register(_),null!=c)return mixpanel.people.set_once(k),mixpanel.people.set(g)}else if(!(m>=5))return m++,setTimeout(A,e)},setTimeout(A,e)):(mixpanel.identify(t),mixpanel.register(_),null!=c?(mixpanel.people.set_once(k),mixpanel.people.set(g)):void 0)},Analytics.prototype.identify_for_tenant=function(t,a,c){var l,d;if(null!=("undefined"!=typeof mixpanel&&null!==mixpanel?mixpanel.config:void 0)?(mixpanel.identify(t.email),mixpanel.register({user_id:t.user_id,tenant_id:t.tenant_id}),null!=a&&mixpanel.people.set(a)):(l=0,d=function(){if(null!=("undefined"!=typeof mixpanel&&null!==mixpanel?mixpanel.config:void 0)){if(mixpanel.identify(t.email),mixpanel.register({user_id:t.user_id,tenant_id:t.tenant_id}),null!=a)return mixpanel.people.set(a)}else if(!(l>=5))return l++,setTimeout(d,e)},setTimeout(d,e)),"undefined"!=typeof analytics&&null!==analytics)return null==c&&(c={}),analytics.identify(t.email,c)},Analytics.prototype.alias_for_site_owner=function(e,t){if("undefined"!=typeof mixpanel&&null!==mixpanel)return mixpanel.alias(e,t)},Analytics.prototype.alias_for_thinkific=function(e){if("undefined"!=typeof mixpanel&&null!==mixpanel)return mixpanel.alias(e)},Analytics.prototype.alias_for_tenant=function(e){if("undefined"!=typeof mixpanel&&null!==mixpanel)return mixpanel.alias(e)},Analytics.prototype.name_tag=function(e){if(null!=("undefined"!=typeof mixpanel&&null!==mixpanel?mixpanel.config:void 0))return mixpanel.name_tag(e)},Analytics.prototype.track=function(e,t,a){"undefined"!=typeof analytics&&null!==analytics&&analytics.track(e,t),null!=("undefined"!=typeof mixpanel&&null!==mixpanel?mixpanel.track:void 0)&&(null!=mixpanel.config?mixpanel.track(e,t,a):(mixpanel.track(e,t),"function"==typeof a&&a()))},Analytics.prototype.track_for_thinkific_system=function(e,t,c){var l;return null!=("undefined"!=typeof mixpanel&&null!==mixpanel&&null!=(l=mixpanel.thinkific_system)?l.config:void 0)?mixpanel.thinkific_system.track(e,t,c):(a.push({action:e,data:t}),"function"==typeof c?c():void 0)},Analytics.prototype.process_system_events_queue=function(){var e,t=this;if(null!=("undefined"!=typeof mixpanel&&null!==mixpanel&&null!=(e=mixpanel.thinkific_system)?e.config:void 0))return a.forEach((function(e){var a,c;return a=e.action,c=e.data,t.track_for_thinkific_system(a,c)})),a=[]},Analytics.prototype.track_links=function(e,t,a){"undefined"!=typeof mixpanel&&null!==mixpanel&&mixpanel.track_links(e,t,a)},Analytics.prototype.track_charge=function(e){null!=("undefined"!=typeof mixpanel&&null!==mixpanel?mixpanel.people:void 0)&&mixpanel.people.track_charge(e)},c=function(e,t){var a;return t=t.replace(/[[]/,"[").replace(/[]]/,"]"),null===(a=new RegExp("[?&]"+t+"=([^&#]*)").exec(e))||a&&"string"!=typeof a[1]&&a[1].length?"":decodeURIComponent(a[1]).replace(/\W/gi," ")},l=function(e){var a,l,d,m,f;for(d={},a=m=0,f=t.length-1;0<=f?m<=f:m>=f;a=0<=f?++m:--m)(l=c(document.URL,t[a])).length&&(d[t[a]+" ["+e+"touch]"]=l);return d},Analytics}(),window.ThinkificAnalytics=new e}.call(this),
/*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */
/*! NOTE: If you're already including a window.matchMedia polyfill via Modernizr or otherwise, you don't need this part */
window.matchMedia=window.matchMedia||function(e){"use strict";var t,a=e.documentElement,c=a.firstElementChild||a.firstChild,l=e.createElement("body"),d=e.createElement("div");return d.id="mq-test-1",d.style.cssText="position:absolute;top:-100em",l.style.background="none",l.appendChild(d),function(e){return d.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>',a.insertBefore(l,c),t=42===d.offsetWidth,a.removeChild(l),{matches:t,media:e}}}(document),
/*! Respond.js v1.3.0: min/max-width media query polyfill. (c) Scott Jehl. MIT/GPLv2 Lic. j.mp/respondjs  */
function(e){"use strict";function x(){u(!0)}var t={};if(e.respond=t,t.update=function(){},t.mediaQueriesSupported=e.matchMedia&&e.matchMedia("only all").matches,!t.mediaQueriesSupported){var a,c,l,d=e.document,m=d.documentElement,f=[],y=[],_=[],g={},k=d.getElementsByTagName("head")[0]||m,A=d.getElementsByTagName("base")[0],C=k.getElementsByTagName("link"),w=[],n=function(){for(var t=0;C.length>t;t++){var a=C[t],c=a.href,l=a.media,d=a.rel&&"stylesheet"===a.rel.toLowerCase();c&&d&&!g[c]&&(a.styleSheet&&a.styleSheet.rawCssText?(p(a.styleSheet.rawCssText,c,l),g[c]=!0):(!/^([a-zA-Z:]*\/\/)/.test(c)&&!A||c.replace(RegExp.$1,"").split("/")[0]===e.location.host)&&w.push({href:c,media:l}))}o()},o=function(){if(w.length){var t=w.shift();v(t.href,(function(a){p(a,t.href,t.media),g[t.href]=!0,e.setTimeout((function(){o()}),0)}))}},p=function(e,t,a){var c=e.match(/@media[^\{]+\{([^\{\}]*\{[^\}\{]*\})+/gi),l=c&&c.length||0,h=function(e){return e.replace(/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,"$1"+t+"$2$3")},d=!l&&a;(t=t.substring(0,t.lastIndexOf("/"))).length&&(t+="/"),d&&(l=1);for(var m=0;l>m;m++){var _,g,k,A;d?(_=a,y.push(h(e))):(_=c[m].match(/@media *([^\{]+)\{([\S\s]+?)$/)&&RegExp.$1,y.push(RegExp.$2&&h(RegExp.$2))),A=(k=_.split(",")).length;for(var C=0;A>C;C++)g=k[C],f.push({media:g.split("(")[0].match(/(only\s+)?([a-zA-Z]+)\s?/)&&RegExp.$2||"all",rules:y.length-1,hasquery:g.indexOf("(")>-1,minw:g.match(/\(\s*min\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:g.match(/\(\s*max\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||"")})}u()},s=function(){var e,t=d.createElement("div"),a=d.body,c=!1;return t.style.cssText="position:absolute;font-size:1em;width:1em",a||((a=c=d.createElement("body")).style.background="none"),a.appendChild(t),m.insertBefore(a,m.firstChild),e=t.offsetWidth,c?m.removeChild(a):a.removeChild(t),l=parseFloat(e)},u=function(t){var g="clientWidth",A=m[g],w="CSS1Compat"===d.compatMode&&A||d.body[g]||A,b={},S=C[C.length-1],T=(new Date).getTime();if(t&&a&&30>T-a)return e.clearTimeout(c),void(c=e.setTimeout(u,30));for(var E in a=T,f)if(f.hasOwnProperty(E)){var P=f[E],D=P.minw,R=P.maxw,$=null===D,M=null===R;D&&(D=parseFloat(D)*(D.indexOf("em")>-1?l||s():1)),R&&(R=parseFloat(R)*(R.indexOf("em")>-1?l||s():1)),P.hasquery&&($&&M||!($||w>=D)||!(M||R>=w))||(b[P.media]||(b[P.media]=[]),b[P.media].push(y[P.rules]))}for(var B in _)_.hasOwnProperty(B)&&_[B]&&_[B].parentNode===k&&k.removeChild(_[B]);for(var F in b)if(b.hasOwnProperty(F)){var I=d.createElement("style"),N=b[F].join("\n");I.type="text/css",I.media=F,k.insertBefore(I,S.nextSibling),I.styleSheet?I.styleSheet.cssText=N:I.appendChild(d.createTextNode(N)),_.push(I)}},v=function(e,t){var a=b();a&&(a.open("GET",e,!0),a.onreadystatechange=function(){4!==a.readyState||200!==a.status&&304!==a.status||t(a.responseText)},4!==a.readyState&&a.send(null))},b=function(){var t=!1;try{t=new e.XMLHttpRequest}catch(a){t=new e.ActiveXObject("Microsoft.XMLHTTP")}return function(){return t}}();n(),t.update=n,e.addEventListener?e.addEventListener("resize",x,!1):e.attachEvent&&e.attachEvent("onresize",x)}}(this);var createOptions=function createOptions(e){return{publishableKey:void 0!==e.publishableKey?e.publishableKey:null,hide_checkout:void 0!==e.hide_checkout&&e.hide_checkout,checkout_coupons_disabled:void 0!==e.checkout_coupons_disabled&&e.checkout_coupons_disabled,errorHandler:void 0!==e.errorHandler?e.errorHandler:null,useSCAFlow:void 0!==e.useSCAFlow&&e.useSCAFlow,cartToken:void 0!==e.cartToken?e.cartToken:"",addCardWithoutPayment:void 0!==e.addCardWithoutPayment&&e.addCardWithoutPayment,jsonWebToken:void 0!==e.jsonWebToken?e.jsonWebToken:null,checkoutSpinnerElementClass:void 0!==e.checkoutSpinnerElementClass?e.checkoutSpinnerElementClass:null,canUseThinkificPayments:!!e.canUseThinkificPayments,locale:e.locale||"en",billingCheckout:!!e.billingCheckout,useBillingApi:!!e.useBillingApi}},instantiateCreditCardForm=function instantiateCreditCardForm(e){var t=createOptions(e);return StripeCreditCardForm.getInstance(t)},recreateCreditCardForm=function instantiateCreditCardForm(e){var t=createOptions(e);return StripeCreditCardForm.forceNewInstance(t)};window.instantiateCreditCardForm=instantiateCreditCardForm,window.recreateCreditCardForm=recreateCreditCardForm;
// IMPORTANT
// Don't use ES6 syntax here (i.e. let) as our PhantomJS version does not support it
// and thus it breaks random cucumber tests that might seem unrelated
/* TODO: (SCA 8/28/19) disabling max statements for now, will be
  refactoring this form next P-period */
/* eslint-disable max-statements */
var StripeCreditCardForm=function(){var e,t,a,c,l,d,m,f,y,_,g={publishableKey:null,hide_checkout:!1,checkout_coupons_disabled:!1,errorHandler:null,useSCAFlow:!1,cartToken:null,billingCheckout:!1,useBillingApi:!1},k=null,getForm=function(){return $("#payment-form")},getSubmitButton=function(){return getForm().find('[type="submit"]')},A={
// Cache this for later
submitText:null},C=function createInstance(d){t=$.extend({},g,d),e=new _StripeCreditCardForm,window.Stripe&&(a=Stripe(t.publishableKey,{locale:d.locale||"en"}),c=a.elements(),k=document.getElementsByClassName(t.checkoutSpinnerElementClass)[0],l=c.create("card",{hidePostalCode:!0,style:{base:{fontFamily:'"Open Sans", sans-serif',fontSmoothing:"antialiased","::placeholder":{color:"#999"}}}}))},w=function toggleSubmitButton(e){m.prop("disabled",e),e?(m.addClass("btn-disabled-spinner btn-circular-spinner"),m.text(Thinkific.t(".js_app_checkout_please_wait"))):(m.removeClass("btn-disabled-spinner btn-circular-spinner"),m.text(A.submitText))},b=function toggleCartProcessingState(e){k&&(e?(m.append(k),k.classList.remove("spinner--hidden")):k.classList.add("spinner--hidden"))},S=function hidePaypalButton(e){var t=document.querySelector(".paypal-button-row");t&&(e?t.classList.add("spinner--hidden"):t.classList.remove("spinner--hidden"))},determineErrorCode=function(e){const a=[/(payment|setup)+_intent_incompatible_payment_method/,/(payment|setup)+_intent_invalid_parameter/,/(payment|setup)+_intent_unexpected_state/,/payment_intent_payment_attempt_failed/,/payment_method_unactivated/,/payment_method_unexpected_state/];return t.addCardWithoutPayment?"processing_error"===e.code?"processing_error":"card_declined"===e.code?function displayDeclinedError(e){return"insufficient_funds"===e.decline_code?"insufficient_funds":"card_not_supported"===e.decline_code?"card_not_supported":"currency_not_supported"===e.decline_code?"currency_not_supported":"add_card_contact_bank_error"}(e):a.some((function(t){return t.test(e.code)}))?"add_card_try_again_error":e.code:a.some((function(t){return t.test(e.code)}))?"transaction_declined":e.code};var T=function stripeResponseHandler(e){e.error?_handleErrorResponse(e):(f.val(e.token.id),d.submit())},E=function productCheckoutServerResponse(e){var t=e.payment_status;e.error?_handleErrorResponse(e):"requires_action"===t?(metadata=e.metadata,"setup_intent"===metadata.intent_type?_setupCard(metadata.client_secret,metadata.order_id,e.payment_method_id):function _confirmPaymentIntent(e,t,c){a.handleCardPayment(e,{payment_method:c}).then((function(e){_handleConfirmPurchase(e,t,0)}))}(metadata.client_secret,metadata.order_id,e.payment_method_id)):"succeeded"===t&&(redirect_url=e.redirect_url||"/",window.location.replace(redirect_url))};function setError(e){var t=getForm().find("#local-payment-errors");e?(t.text(e),t.show()):(t.text(""),t.hide())}var P=function toggleCouponFormHidden(e){e?$(".order-product__coupon, .thinkific__checkout__coupon-code__form-container").hide():$(".order-product__coupon, .thinkific__checkout__coupon-code__form-container").show()},D=function submit(e){(!function isStripeTokenSet(){return""!==f.val()}()||t.useSCAFlow||t.billingCheckout)&&(e&&e.preventDefault(),function _handleSubmitHelpers(){A.submitText=getSubmitButton().text(),S(!0),w(!0),b(!0),setError(""),t.checkout_coupons_disabled||P(!0)}(),function _handleSubmit(){if(t.canUseThinkificPayments)return _addCardWithoutPayment();
// Handles 'submit' action for credit card form in Student Billings with SCA enabled
if(t.useSCAFlow&&t.addCardWithoutPayment)return _addCardWithoutPayment();
// Handles 'submit' action for Product Checkout with SCA enabled
if(t.useSCAFlow)return function _submitWithSCA(){_?function getPaymentMethod(e){return a.createPaymentMethod("card",e)}(l).then((function(e){e.error?_handleErrorResponse(e):_makeServerRequest("/checkouts/create_stripe_purchase/",{payment_method_id:e.paymentMethod.id,product_price_id:y.val(),using_new_card:_},E)})):_makeServerRequest("/checkouts/create_stripe_purchase/",{product_price_id:y.val(),using_new_card:_},E)}();
// with SCA enabled
if(t.billingCheckout)return function handleBillingCheckout(){if(!_)
// If stripeToken is nil, we just assume that
// the customer object in Stripe already has a default payment method
return createBillingPayment(null);a.createToken(l).then((function(e){return e.error?_handleErrorResponse(e):createBillingPayment(e.token.id)}))}();
// Handles 'submit action for Product Checkout and credit card form in Student Billings
// when SCA is not enabled
return a.createToken(l).then(T)}())};
/**
   * Old Flow:
   * This method is submitted twice, the first time
   * we stop submission to request stripe a payment identifier.
   * When handling stripe's response, we're then re-submitting
   * the form which is why the first statement checks if we have
   * the token and allows submission.
   * New Flow:
   * This method is only submitted once, but effectively calls the backend
   * twice (first to create a PaymentIntent, then to confirm that PaymentIntent
   * if needed (i.e. for cards requiring 3D secure)).
   * @param {event} e
   */
// eslint-disable-next-line complexity
function createBillingPayment(e){var a=new URLSearchParams(window.location.search),c=document.getElementById("country_code"),l=document.getElementById("zip_code"),d="/manage/subscription/checkout",m=document.querySelector('[name="addon_price_slug"]'),f=document.querySelector('[name="addon_quantity"]');m&&(d="/manage/subscription/checkout/addon_create"),
// SMDT-154: Remove the two different URLs when billing API is used in production
t.useBillingApi&&(d="/manage/subscription/billing_checkout"),_makeServerRequest(d,{stripeToken:e,token:a.get("token"),plan:document.querySelector('[name="plan"]').value,plan_slug:document.querySelector('[name="plan_slug"]').value,addon_price_slug:m&&m.value,addon_quantity:f&&f.value,period:document.querySelector('[name="period"]').value,country_code:c&&c.value,zip_code:l&&l.value,confirmed_by_customer:!0},billingCheckoutServerResponse)}function billingCheckoutServerResponse(e){const t=e.payment_status;e.error?_handleErrorResponse(e):"requires_action"===t?function confirmBillingPaymentIntent(e){a.confirmCardPayment(e.client_secret).then((function(t){!function handleBillingResponse(e,t){e.error?_handleErrorResponse(e):"created"===t.change_type?function confirmBillingPayment(e){var t=new URLSearchParams(window.location.search);_makeServerRequest("/manage/subscription/checkout/confirm",{paymentIntent:e.paymentIntent.id,token:t.get("token"),plan:document.querySelector('[name="plan"]').value},billingCheckoutServerResponse)}(e):window.location.replace(t.redirect_url)}(t,e)}))}(e):"succeeded"===t&&window.location.replace(e.redirect_url)}function _makeServerRequest(e,a,c,l){l||(l=function(){});
// We need to include the authenticity_token in the request, otherwise Rails
// performs the request with a null session
const d=document.querySelector("meta[name='csrf-token']"),m=document.querySelector("meta[name='csrf-param']");if(d&&m){const e=d.getAttribute("content");a[m.getAttribute("content")]=e}const f=t.cartToken?e+t.cartToken:e;"function"==typeof fetch?fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin",body:JSON.stringify(a)}).then((function(e){e.json().then(c)})).catch(l):$.ajax({url:f,data:a,method:"POST",dataType:"json",crossDomain:!1}).then(c).catch(l)}function _handleErrorResponse(e){var a,c,l,d="string"==typeof e.error?e.error:(a=e.error,c=".js_app_payment_errors."+determineErrorCode(a),l=Thinkific.t(c),/Translation missing/.test(l)?a.message:l);e.redirect_url?(e.couponRemoved||
// the redirect url for when a coupon is removed handles showing the error without an alert
// so we don't want to trigger an alert here
alert(d),window.location.assign(e.redirect_url)):
// eslint-disable-next-line complexity
function _display_error(e,a){a&&setError(a);t.checkout_coupons_disabled||P(!1);if(S(!1),w(!1),b(!1),t.errorHandler&&"function"==typeof t.errorHandler)try{t.errorHandler(e.error)}catch(e){
// swallow the error here
}}(e,d)}function _handleConfirmPurchase(e,t,a){try{e.error?_handleErrorResponse(e):_makeServerRequest("/checkouts/confirm_stripe_purchase/",{order_id:t,payment_data:{payment_method_id:e.paymentIntent.payment_method,payment_intent_id:e.paymentIntent.id,using_new_card:_},product_price_id:y.val()},E,(function handleConfirmError(c){window.airbrake.notify({error:c,context:{severity:"warning",component:"checkout"},params:{retry:a}}),_retryConfirmPurchase(e,t,a)}))}catch(c){window.airbrake.notify({error:c,context:{severity:"warning",component:"checkout"},params:{retry:a}}),_retryConfirmPurchase(e,t,a)}}function _retryConfirmPurchase(e,t,a){a>4||setTimeout((function(){_handleConfirmPurchase(e,t,a+1)}),500)}function _setupCard(e,t,c){a.handleCardSetup(e,{payment_method:c}).then((function(e){e.error?_handleErrorResponse(e):_makeServerRequest("/checkouts/confirm_stripe_purchase/",{order_id:t,payment_data:{payment_method_id:e.setupIntent.payment_method,setup_intent_id:e.setupIntent.id,using_new_card:_},product_price_id:y.val()},E)}))}function _addCardWithoutPayment(){_makeServerRequest("/account/credit_card/create_setup_intent",{token:t.jsonWebToken},M)}var R=function attachPaymentMethodServerResponse(e){e.error?_handleErrorResponse(e):window.location.assign(e.redirect_url)},M=function createSetupIntentServerResponse(e){e.error?_handleErrorResponse(e):a.handleCardSetup(e.setup_intent.client_secret,l,{}).then((function(e){e.error?_handleErrorResponse(e):function _attachPaymentMethod(e){_makeServerRequest("/account/credit_card/attach_payment_method",{payment_method_id:e,token:t.jsonWebToken},R)}(e.setupIntent.payment_method)}))};
// create definition of private function
function _StripeCreditCardForm(){}return _StripeCreditCardForm.prototype.getStripeElement=function(){return c},_StripeCreditCardForm.prototype.submit=D,_StripeCreditCardForm.prototype.clearExpiredCaptchaResponse=function _resetRecaptchaResponse(){var e=document.getElementById("g-recaptcha-response");e&&(e.value=""),"undefined"!=typeof grecaptcha&&grecaptcha.reset()},_StripeCreditCardForm.prototype.mount=function(){try{d=getForm(),m=getSubmitButton(),f=d.find("#stripe-token"),y=d.find("#product-price-id"),
// mount credit card form element
d.find("#credit-card-elements").length?(l.mount("#credit-card-elements"),_=!0):_=!1,m.removeClass("hidden"),d.off("submit"),
// mount checkout form
d.submit(D)}catch(e){
// In the case where the credit card fields are not present, due to
// either a coupon reducing the total to $0.00 or when the user has a
// stored credit card, this error is thrown.
if("IntegrationError"!==e.name)throw e}},{getInstance:function getInstance(t){return e||C(t),e.mount(),e},forceNewInstance:function forceNewInstance(t){return e&&l.destroy(),C(t),e.mount(),e}}}();
/*! jstz - v1.0.4 - 2012-12-12 */!function(e){var t=function(){"use strict";var n=function(e){var t=-e.getTimezoneOffset();return null!==t?t:0},r=function(e,t,a){var c=new Date;return void 0!==e&&c.setFullYear(e),c.setDate(a),c.setMonth(t),c},i=function(e){return n(r(e,0,2))},s=function(e){return n(r(e,5,2))},u=function(){var e=i(),t=s(),a=i()-s();return a<0?e+",1":a>0?t+",1,s":e+",0"};return{determine:function(){var e=u();return new t.TimeZone(t.olson.timezones[e])},date_is_dst:function(e){return(e.getMonth()>7?s(e.getFullYear()):i(e.getFullYear()))-n(e)!=0}}}();t.TimeZone=function(e){"use strict";var a=null;return a=e,void 0!==t.olson.ambiguity_list[a]&&function(){for(var e=t.olson.ambiguity_list[a],c=e.length,l=0,d=e[0];l<c;l+=1)if(d=e[l],t.date_is_dst(t.olson.dst_start_dates[d]))return void(a=d)}(),{name:function(){return a}}},t.olson={},t.olson.timezones={"-720,0":"Etc/GMT+12","-660,0":"Pacific/Pago_Pago","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Santiago","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"Etc/GMT+2","-120,1":"Etc/GMT+2","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"Etc/UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Tarawa","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},t.olson.dst_start_dates=function(){"use strict";var e=new Date(2010,6,15,1,0,0,0);return{"America/Denver":new Date(2011,2,13,3,0,0,0),"America/Mazatlan":new Date(2011,3,3,3,0,0,0),"America/Chicago":new Date(2011,2,13,3,0,0,0),"America/Mexico_City":new Date(2011,3,3,3,0,0,0),"America/Asuncion":new Date(2012,9,7,3,0,0,0),"America/Santiago":new Date(2012,9,3,3,0,0,0),"America/Campo_Grande":new Date(2012,9,21,5,0,0,0),"America/Montevideo":new Date(2011,9,2,3,0,0,0),"America/Sao_Paulo":new Date(2011,9,16,5,0,0,0),"America/Los_Angeles":new Date(2011,2,13,8,0,0,0),"America/Santa_Isabel":new Date(2011,3,5,8,0,0,0),"America/Havana":new Date(2012,2,10,2,0,0,0),"America/New_York":new Date(2012,2,10,7,0,0,0),"Asia/Beirut":new Date(2011,2,27,1,0,0,0),"Europe/Helsinki":new Date(2011,2,27,4,0,0,0),"Europe/Istanbul":new Date(2011,2,28,5,0,0,0),"Asia/Damascus":new Date(2011,3,1,2,0,0,0),"Asia/Jerusalem":new Date(2011,3,1,6,0,0,0),"Asia/Gaza":new Date(2009,2,28,0,30,0,0),"Africa/Cairo":new Date(2009,3,25,0,30,0,0),"Pacific/Auckland":new Date(2011,8,26,7,0,0,0),"Pacific/Fiji":new Date(2010,11,29,23,0,0,0),"America/Halifax":new Date(2011,2,13,6,0,0,0),"America/Goose_Bay":new Date(2011,2,13,2,1,0,0),"America/Miquelon":new Date(2011,2,13,5,0,0,0),"America/Godthab":new Date(2011,2,27,1,0,0,0),"Europe/Moscow":e,"Asia/Yekaterinburg":e,"Asia/Omsk":e,"Asia/Krasnoyarsk":e,"Asia/Irkutsk":e,"Asia/Yakutsk":e,"Asia/Vladivostok":e,"Asia/Kamchatka":e,"Europe/Minsk":e,"Australia/Perth":new Date(2008,10,1,1,0,0,0)}}(),t.olson.ambiguity_list={"America/Denver":["America/Denver","America/Mazatlan"],"America/Chicago":["America/Chicago","America/Mexico_City"],"America/Santiago":["America/Santiago","America/Asuncion","America/Campo_Grande"],"America/Montevideo":["America/Montevideo","America/Sao_Paulo"],"Asia/Beirut":["Asia/Beirut","Europe/Helsinki","Europe/Istanbul","Asia/Damascus","Asia/Jerusalem","Asia/Gaza"],"Pacific/Auckland":["Pacific/Auckland","Pacific/Fiji"],"America/Los_Angeles":["America/Los_Angeles","America/Santa_Isabel"],"America/New_York":["America/Havana","America/New_York"],"America/Halifax":["America/Goose_Bay","America/Halifax"],"America/Godthab":["America/Miquelon","America/Godthab"],"Asia/Dubai":["Europe/Moscow"],"Asia/Dhaka":["Asia/Yekaterinburg"],"Asia/Jakarta":["Asia/Omsk"],"Asia/Shanghai":["Asia/Krasnoyarsk","Australia/Perth"],"Asia/Tokyo":["Asia/Irkutsk"],"Australia/Brisbane":["Asia/Yakutsk"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Tarawa":["Asia/Kamchatka"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"],"Asia/Baghdad":["Europe/Minsk"]},"undefined"!=typeof exports?exports.jstz=t:e.jstz=t}(this),
// So the forgot password email field will be pre-filled
$((function(){var e=$(".forgot-password").attr("href"),t=$("div#sign-in").length>0?$("div#sign-in #user_email"):$("#user_email");t.on("keyup",(function(){var a=e+"?email="+t.val();$(".forgot-password").attr("href",a)}))})),function main(e,t){
// eslint-disable-next-line no-param-reassign
e.onload=function thinkificFlashMessages(){e.Thinkific&&e.Thinkific.toaster?function showMessagesWithToaster(){t.querySelectorAll("div.flash .message").forEach((function innerForEach(t){var a,c,l,d,m;(a=t.attributes).getNamedItem("data-message")&&(c=a.getNamedItem("data-message").value),a.getNamedItem("data-type")&&(l=a.getNamedItem("data-type").value),c&&(m="notice"===l,d=
// eslint-disable-next-line complexity
function determineToastType(e){switch(e){case"alert":case"error":return"alert";case"notice":case"fixed":default:return"notice";case"info":return"info";case"warning":return"warning"}}(l),e.Thinkific.toaster(c,{type:d,autoClose:m}))}))}():function showMessagesWithoutToast(){const e=document.getElementById("notifications"),t=document.getElementById("flash");if(e&&t){e.style.display="block",
// Send focus so screenreader users hear the messages
t.focus();
// Auto close notifications unless they contain error or fixed messages
const a=e.getElementsByClassName("message-error"),c=e.getElementsByClassName("message-fixed");0===a.length&&0===c.length&&setTimeout((()=>{e.style.display="none"}),4600),e.addEventListener("click",(function onClick(){this.style.display="none"}))}}(),e.Thinkific&&e.Thinkific.fetchAndDisplayNotifications&&e.Thinkific.fetchAndDisplayNotifications()}}(window,document);